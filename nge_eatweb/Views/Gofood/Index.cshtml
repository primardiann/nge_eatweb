@model nge_eatweb.Models.ViewModels.GofoodTransaksiPageViewModel

@{
    ViewData["Title"] = "Transaksi GoFood";
    Layout = "~/Views/Shared/_DashboardLayout.cshtml";
}

<div class="flex min-h-screen bg-[#FAFAFA] text-sm">
    <main class="flex-1 px-8 py-6">
        <!-- Breadcrumb -->
        <div class="text-gray-500 mb-4 flex items-center space-x-1">
            <a href="/dashboard" class="text-black font-semibold hover:underline">Dashboard</a>
            <span class="text-[#888]">></span>
            <span class="text-[#888]">Transaksi GoFood</span>
        </div>

        <!-- Header dan Tombol Tambah -->
        <div class="flex justify-between items-center mb-6">
            <button class="flex items-center gap-2 px-3 py-1 text-white font-medium rounded-lg"
                    style="background-color: #F58220;" onclick="openTambahModal()">
                <span class="text-lg">+</span>
                <span>Tambah Transaksi</span>
            </button>
            <input type="date" id="tanggalFilter" name="tanggalFilter" class="px-3 py-1 border rounded" />
        </div>

        <!-- Tabel Transaksi -->
        <div class="bg-white rounded-xl shadow-md overflow-hidden">
            <table class="min-w-full table-auto">
                <thead class="bg-[#ffd5ab] text-gray-700 text-center text-sm font-semibold select-none">
                    <tr>
                        <th class="px-6 py-3">ID Pesanan</th>
                        <th class="px-6 py-3">Tanggal</th>
                        <th class="px-6 py-3">Kategori</th>
                        <th class="px-6 py-3">Nama Pelanggan</th>
                        <th class="px-6 py-3 max-w-[150px]">Item</th>
                        <th class="px-6 py-3">Aksi</th>
                    </tr>
                </thead>
                <tbody class="text-center text-sm text-gray-700">
                    @if (Model.TransaksiList.Any())

                    {
                        foreach (var t in Model.TransaksiList)

                        {
                            <tr class="border-t hover:bg-gray-50">
                                <td class="px-6 py-3">@t.IdPesanan</td>
                                <td class="px-6 py-3">@t.TanggalTransaksi.ToString("yyyy-MM-dd")</td>
                                <td class="px-6 py-3">
                                    <ul>
                                        @foreach (var item in t.Items)
                                        {
                                            <li>@item.Kategori</li>
                                        }
                                    </ul>
                                </td>
                                <td class="px-6 py-3">@t.NamaPelanggan</td>
                                <td class="px-6 py-3">
                                    <ul>
                                        @foreach (var item in t.Items)
                                        {
                                            <li>@item.NamaItem</li>
                                        }
                                    </ul>
                                </td>
                                <td class="px-6 py-3">
                                    <div class="flex justify-center space-x-4">
                                        <!-- Tombol Detail dengan ikon mata -->
                                        <button class="text-green-600 hover:text-green-800" title="Detail"
                                                onclick='openTransactionDetailModal(@Html.Raw(System.Text.Json.JsonSerializer.Serialize(t)))'>
                                            <i class="fas fa-eye text-lg"></i>
                                        </button>

                                        @* <!-- Tombol Edit -->
                                        <a asp-action="Edit" asp-route-id="@t.IdTransaksi" class="text-blue-600 hover:text-blue-800" title="Edit">
                                            <i class="fas fa-pen-to-square text-lg"></i>
                                        </a> *@


                                        <!-- Tombol Hapus -->
                                        <button class="text-red-600 hover:text-red-800" title="Hapus">
                                            <i class="fas fa-trash-alt text-lg"></i>
                                        </button>
                                    </div>
                                </td>

                            </tr>
                        }
                    }
                    else
                    {
                        <tr>
                            <td colspan="5" class="py-6 text-center text-gray-500">Belum ada transaksi.</td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </main>
</div>

<div id="transactionTambahModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 hidden">
    <div class="bg-white rounded-md shadow-md p-6 w-full max-w-3xl max-h-[90vh] overflow-auto">
        <h2 class="text-xl font-semibold mb-4 border-b pb-2" style="border-color: #F58220;">Tambah Transaksi</h2>

        @await Html.PartialAsync("_GofoodTransaksiFormPartial", Model.FormModel)
    </div>
</div>



@section Scripts {
    <script>
        function openTambahModal() {
            document.getElementById('transactionTambahModal').classList.remove('hidden');
            document.getElementById('transactionTambahModal').classList.add('flex');
        }

        function closeTambahModal() {
            document.getElementById('transactionTambahModal').classList.remove('flex');
            document.getElementById('transactionTambahModal').classList.add('hidden');
        }
    </script>
}
